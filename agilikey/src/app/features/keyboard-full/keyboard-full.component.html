<div class="keyboard-full-container">
  <div class="stats-panel">
    <div class="stat">
      <span class="stat-label">Corretas:</span>
      <span class="stat-value correct">{{ stats.correct }}</span>
    </div>
    <div class="stat">
      <span class="stat-label">Erros:</span>
      <span class="stat-value incorrect">{{ stats.incorrect }}</span>
    </div>
    <div class="stat">
      <span class="stat-label">Precisão:</span>
      <span class="stat-value">{{ getAccuracy() }}%</span>
    </div>
    <div class="stat">
      <span class="stat-label">PPM:</span>
      <span class="stat-value">{{ stats.wpm }}</span>
    </div>
    <button class="reset-btn" (click)="resetExercise()">Novo Exercício</button>
  </div>

  <div class="practice-area">
    <div class="target-text">
      @for (char of targetText.split(''); track $index) {
        <span
          [class.correct]="characterStates[$index] === 'correct'"
          [class.incorrect]="characterStates[$index] === 'incorrect'"
          [class.current]="$index === currentIndex">
          {{ char === ' ' ? '\u00A0' : char }}
        </span>
      }
    </div>
  </div>

  <div class="keyboard">
    @for (row of [1, 2, 3, 4, 5]; track $index) {
      <div class="keyboard-row">
        @for (key of getKeysForRow(row); track $index) {
          <div
            class="key"
            [class.pressed]="pressedKeys.has(key.id)"
            [class.highlight]="nextKeysToHighlight.includes(key.id)"
            [class.shift-active]="isShiftPressed && (key.id === 'shiftleft' || key.id === 'shiftright')"
            [attr.data-finger]="key.finger"
            [style.flex]="key.width || 1"
          >
            @if (key.upperLabel) {
              <span class="key-upper">{{ key.upperLabel }}</span>
            }
            <span class="key-main">{{ key.label }}</span>
          </div>
        }
      </div>
    }
  </div>
</div>
